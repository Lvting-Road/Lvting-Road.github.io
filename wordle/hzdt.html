<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
        <title>杭州地铁 Wordle / Hangzhou Metro Wordle</title>
        <base href="..">
        <link rel="stylesheet" href="newstyle.css">
        <style>
            main {
                padding: 15px;
            }

            input {
                margin: 5px;
                width: 50px;
                height: 50px;
                font-size: 29px;
                text-align: center;
                /* 不显示默认边框 */
                outline: none;
                /* 白色文字 */
                color: #fff;
                border: 1.5px solid #808080;
                border-radius: 3px;
            }

            input#real {
                width: 267px;
                color: #000;
            }

            button {
                color: #fff;
                width: 55px;
                height: 55px;
            }

            #err {
                font-weight: bold;
                color: #d86868;
            }

            #suc {
                font-weight: bold;
                color: #68d877;
            }
        </style>
    </head>
    <body>
        <nav>
            <strong>杭州地铁 Wordle / Hangzhou Metro Wordle</strong>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <small>by 一只SystemErrorO-o</small>
        </nav>

        <main>
            <p style="color: #666; font-weight: bold;">说明：绿色代表有这个字，且位置正确；黄色代表有这个字，且位置错误；灰色代表没有这个字。</p>
            <p id="xzcd"></p>
            <!-- 我为什么不能直接用 align="center"？它明明更直接，更简单，也能实现我的需求。我为什么一定要用 0 auto？ -->
            <table id="srk" align="center"></table>
            <p><a id="err"></a><a id="suc"></a></p>
        </main>

        <script>
            // 纯杭州地铁，不带绍兴、海宁
            const PURE_HZ = [
'湘湖', '滨康路', '西兴', '滨和路', '江陵路', '近江', '婺江路', '城站', '定安路', '龙翔桥', '凤起路', '武林广场', '西湖文化广场', '打铁关', '闸弄口', '火车东站', '彭埠', '七堡', '九和路', '九堡', '客运中心', '下沙西', '金沙湖', '高沙路', '文泽路', '文海南路', '云水', '下沙江滨', '杭州大会展中心', '港城大道', '南阳', '向阳路', '萧山国际机场',

'朝阳', '曹家桥', '潘水', '人民路', '人民广场', '建设一路', '建设三路', '振宁路', '飞虹路', '盈丰路', '钱江世纪城', '钱江路', '庆春广场', '庆菱路', '建国北路', '中河北路', '凤起路', '武林门', '沈塘桥', '下宁桥', '学院路', '丰潭路', '文新', '三坝', '虾龙圩', '三墩', '墩祥街', '金家渡', '白洋', '杜甫村', '良渚',

'星桥', '黄鹤山', '华鹤街', '丁桥', '桃花湖公园', '同协路', '华丰路', '汽轮广场', '新天地街', '善贤', '大关', '香积寺', '潮王路', '西湖文化广场', '武林广场', '武林门', '黄龙洞', '黄龙体育中心', '古荡', '古荡新村', '古墩路', '东岳', '花坞', '西溪湿地南', '洪园', '联胜路', '高教路', '全丰', '绿汀路', '文一西路', '龙舟北路', '火车西站', '吴山前村', '西溪湿地南', '留下', '屏峰', '小和山', '石马',

'池华街', '金家渡', '好运街', '杭行路', '储运路', '平安桥', '独城生态公园', '吴家角港', '桃源街', '皋亭坝', '新天地街', '华中南路', '笕桥老街', '黎明', '明石路', '彭埠', '火车东站', '新风', '新塘', '景芳', '钱江路', '江锦路', '市民中心', '城星路', '近江', '甬江路', '南星桥', '复兴路', '水澄桥', '联庄', '中医药大学', '杨家墩', '浦沿',

'南湖东', '金星', '绿汀路', '葛巷', '创景路', '良睦路', '杭师大仓前', '永福', '五常', '蒋村', '浙大紫金港', '三坝', '萍水街', '和睦', '大运河', '拱宸桥东', '善贤', '西文街', '东新园', '杭氧', '打铁关', '宝善桥', '建国北路', '万安桥', '城站', '江城路', '候潮门', '南星桥', '长河', '聚才路', '江晖路', '滨康路', '博奥路', '金鸡路', '人民广场', '育才北路', '通惠中路', '火车南站', '双桥', '姑娘桥',

'枸桔弄', '火车东站东广场', '元宝塘', '昙花庵路', '三堡', '亚运村', '丰北', '钱江世纪城', '博览中心', '奥体中心', '星民', '江陵路', '江汉路', '长河', '建业路', '诚业路', '伟业路', '中医药大学', '西浦路', '之江文化中心', '枫桦西路', '美院象山', '音乐学院', '中村', '野生动物园东', '银湖', '虎啸杏', '受降', '富阳客运中心', '高桥', '阳陂湖', '公望街', '桂花西路', '美院象山', '霞鸣街', '科海路', '双浦',

'吴山广场', '江城路', '莫邪塘', '观音塘', '市民中心', '奥体中心', '兴议', '明星路', '建设三路', '新兴路', '新汉路', '新街', '合欢路', '盈中', '坎山', '新港', '萧山国际机场', '永盛路', '新镇路', '义蓬', '塘新线', '青六中路', '启成路', '江东二路',

'文海南路', '工商大学云滨', '桥头堡', '河庄路', '青西三路', '青六中路', '仓北村', '冯娄村', '新湾路',

'观音塘', '新业路', '钱江路', '江河汇', '三堡', '御道', '五堡', '六堡', '红普南路', '九睦路', '客运中心', '乔司南', '乔司', '翁梅', '临平南高铁站', '南苑', '临平', '邱山大街', '荷禹路', '五洲路', '龙安',

'逸盛路', '金德路', '杭行路', '祥园路', '渡驾桥', '花园岗', '和睦', '北大桥', '翠柏路', '学院路', '文三路', '黄龙体育中心',

'绿汀路', '凤新路', '禹航路', '中泰', '南湖', '南峰', '青山湖科技城', '八百里', '青山湖', '农林大学', '临安广场', '九州街',

'永盛路', '萧山国际机场', '知行路', '耕文路', '平澜路', '御道', '火车东站', '东广场', '驿城路', '西湖文化广场', '沈塘桥', '文三路', '五联', '西溪湿地北', '荆长路', '创景路', '火车西站'
];
            // 杭州都市圈，带绍兴、海宁
            const HZ = PURE_HZ + [
'临平南高铁站', '许村', '海宁高铁西站', '长安', '东方学院', '长安东', '周王庙', '盐官', '桐九公路', '斜桥', '皮革城', '海昌路', '浙大国际校区',

'姑娘桥', '衙前', '杨汛桥', '前梅', '钱清', '西沙路', '临杭大道', '鉴水路', '越州大道', '中国轻纺城', '明珠广场', '瓜渚湖', '镜水路', '黄酒小镇', '奥体中心', '梅山广场', '凤林', '大滩', '火车站', '城市广场', '鲁迅故里', '城南大道', '凤凰山', '劳家葑', '南池', '栖湖', '芳泉',

'黄酒小镇', '绍兴一中', '湖西', '大庆寺', '绍兴北站', '会展中心',

'人民医院总院', '梅山广场', '后墅路', '袍谷', '袍中路', '海径湖', '恂南', '豆浆', '檀渎'
];

            const ERR = document.getElementById('err');
            const SUC = document.getElementById('suc');
            // 站名长度  
            let len = 4;
            let correct = '';
            function newGame(length, stations=PURE_HZ) {
                // 选取车站
                // length：站名长度
                // stations：HZ 或 PURE_HZ
                len = length;
                correct = '';
                while (correct.length != len) {
                    correct = stations[Math.floor(Math.random() * stations.length)];
                }
                ERR.innerText = '';
                SUC.innerText = '';
                // iH innerHTML
                // 因为直接往 innerHTML 里加会自动解析掉，所以只能放在 iH 里
                let iH = '请选择站名长度：';
                for (let i = 2; i < 8; ++i) {
                    iH += `<button class="circle ${[i == len ? 'green' : 'gray']}" onclick='newGame(${i})'>${i}</button> `;
                }
                // xzcd 选择长度
                document.getElementById('xzcd').innerHTML = iH;
                iH = '<tr>';
                for (let i = 0; i < 10; ++i) {
                    for (let j = 0; j < len; ++j)
                        // 添加输入框
                        iH += '<td><input disabled></td>';
                    iH += '</tr>\n<tr>';
                }
                if (len > 3)
                    iH += '<td colspan=4><input id="real"></td>';
                else {
                    iH += '<td colspan=2><input id="real" style="width: 125px;"></td>';
                    iH += '</tr>\n<tr>';
                }
                iH += '<td><button class="green" onclick="submit()">√</button></td>';
                iH += '<td><button class="red" onclick="qcsr()">⨉</button></td>';
                iH += `<td><button class="blue" onclick="newGame(${len})">↻</button></td></tr>\n`;
                // srk 输入框
                document.getElementById('srk').innerHTML = iH;
            }
            newGame(4);
            
            function submit() {
                // 提交用户输入的站名
                let name = document.getElementById('real').value;
                if (name.length != len) {
                    ERR.innerText = '请检查输入长度';
                    return;
                } if (!(/^[\u4e00-\u9fa5]+$/.test(name))) {
                    ERR.innerText = '请输入中文';
                    return;
                }
                ERR.innerText = '';
                // 通过检查，用户输入合理
                let j = 0;
                for (let tr of document.querySelectorAll('#srk tr')) {
                    j += 1;
                    if (tr.firstChild.firstChild.value) continue; // 这行已经有站名了，去下一行
                    // 添加站名
                    let i = -1;
                    let flag = true;
                    for (let input of tr.querySelectorAll('input')) {
                        input.removeAttribute('disabled');
                        let char = name[++i];
                        // 若整行都是绿的，表明用户猜对
                        if (correct.indexOf(char) + 1)
                            if (correct[i] == char)
                                // 汉字正确，位置正确，绿色
                                input.setAttribute('class', 'green');
                            else {
                                // 汉字正确，位置错误，黄色
                                flag = false;
                                input.setAttribute('class', 'yellow');
                            }
                        else {
                            // 都错了，灰色
                            flag = false;
                            input.setAttribute('class', 'gray');
                        }
                        // 显示文字
                        input.value = char;
                        input.setAttribute('readonly', 'readonly');
                    }
                    if (flag) {
                        SUC.innerText = '恭喜猜对！'
                    }
                    break;
                }
                if (j == 10)
                    // 全错
                    ERR.innerText = `正确答案是 ${correct}`;
            }

            // qcsr 清除输入
            function qcsr() {
                document.getElementById('real').value = '';
                ERR.innerText = '';
                SUC.innerText = '';
            }
        </script>
    </body>
</html>
